function Append_RunFile_line3(RunFile_no, ...
              icontr, rate_11, rate_22, rate_33, rate_12, rate_13, rate_23, ...
              igoal,  krotat,  finalv,  ipts,    idump,   iflexc,  imicro,  ...
              ibodyf, defdot,  ipts2,   iplot, 
              ivers=6, icontp=[], vrate=[]);
%
% |+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|+|
%
% This function appends a single line of input to the bottom of an existing  
% DEMPLA RunFile.  The line gives data for a single period of 
% deformation-stress control
%
% The function call is given below.  The input arguments are as follows:
%   RunFile_no  the integer value of the file number of the file to which
%               the line of input data is being appended.  This file
%               would have been created in the calling script (or function),
%               with the command:
%                  RunFile_no = fopen(<file name>, 'r');
%   most of the remaining arguments are values that are described in the
%               RunFile section of the DEMPLA documentation.
%   ivers       the RunFile version number (probably a value of 6)
%
% Output:  none
%
% Dependencies:  none
%
% Function call...
%
% Append_RunFile_line3(RunFile_no, ...
%             icontr, rate_11, rate_22, rate_33, rate_12, rate_13, rate_23, ...
%             igoal,  krotat,  finalv,  ipts,    idump,   iflexc,  imicro,  ...
%             ibodyf, defdot,  ipts2,   iplot,
%             ivers=6, icontp=[], vrate=[]);
%
%
  if igoal==70
    finalv_format = ' %#9.0f';
  else
    finalv_format = ' %-+1.2e';
  end
%
if ivers < 5
  OUTPUT = sprintf(strcat('%06i', ...
                          ' %9s %9s %9s %9s %9s %9s', ...
                          ' %02i', ...
                          ' %1i', ...
                          finalv_format, ...
                          ' %4i', ...
                          ' %1i', ...
                          ' % 2i', ...
                          ' %1i', ...
                          ' % 2i', ...
                          ' % #6.0f', ...
                          ' % 4i', ...
                          ' % 2i', ...
                          '\n' ...
                         ), ...
                            icontr, ...
                            Floating_one_digit_exponent('%#9.3e', rate_11), ...
                            Floating_one_digit_exponent('%#9.3e', rate_22), ...
                            Floating_one_digit_exponent('%#9.3e', rate_33), ...
                            Floating_one_digit_exponent('%#9.3e', rate_12), ...
                            Floating_one_digit_exponent('%#9.3e', rate_13), ...
                            Floating_one_digit_exponent('%#9.3e', rate_23), ...
                            igoal, ...
                            krotat, ...
                            finalv, ...
                            ipts, ...
                            idump, ...
                            iflexc, ...
                            imicro, ...
                            ibodyf, ...
                            defdot, ...
                            ipts2, ...
                            iplot  ...
                  );
  fprintf(RunFile_no, OUTPUT);
else
  OUTPUT = sprintf(strcat('%06i', ...
                          ' %1i', ...
                          ' %9s %9s %9s %9s %9s %9s %9s', ...
                          ' %02i', ...
                          ' %1i', ...
                          finalv_format, ...
                          ' %4i', ...
                          ' %1i', ...
                          ' % 2i', ...
                          ' %1i', ...
                          ' % 2i', ...
                          ' % #6.0f', ...
                          ' % 4i', ...
                          ' % 2i', ...
                          '\n' ...
                         ), ...
                            icontr, ...
                            icontp, ...
                            Floating_one_digit_exponent('%#9.3e', rate_11), ...
                            Floating_one_digit_exponent('%#9.3e', rate_22), ...
                            Floating_one_digit_exponent('%#9.3e', rate_33), ...
                            Floating_one_digit_exponent('%#9.3e', rate_12), ...
                            Floating_one_digit_exponent('%#9.3e', rate_13), ...
                            Floating_one_digit_exponent('%#9.3e', rate_23), ...
                            Floating_one_digit_exponent('%#9.3e', vrate), ...
                            igoal, ...
                            krotat, ...
                            finalv, ...
                            ipts, ...
                            idump, ...
                            iflexc, ...
                            imicro, ...
                            ibodyf, ...
                            defdot, ...
                            ipts2, ...
                            iplot  ...
                  );
  fprintf(RunFile_no, OUTPUT);
end
